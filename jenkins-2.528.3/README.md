# ğŸ“ Jenkins CI/CD System Specification (Air-gapped)

ë³¸ ë¬¸ì„œëŠ” **Rocky Linux 9.6** ê¸°ë°˜ íì‡„ë§ í™˜ê²½ì—ì„œ ìš´ì˜ë˜ëŠ” Jenkins ë¹Œë“œ ì‹œìŠ¤í…œì˜ êµ¬ì„± ë° ìš´ì˜ ëª…ì„¸ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

## 1. ì‹œìŠ¤í…œ ê°œìš” (System Overview)

JenkinsëŠ” Kubernetes í™˜ê²½ì—ì„œ **StatefulSet**ìœ¼ë¡œ ìš´ì˜ë˜ë©°, ë¹Œë“œ ë¶€í•˜ì— ë”°ë¼ ë™ì ìœ¼ë¡œ ì—ì´ì „íŠ¸(Worker)ë¥¼ ìƒì„±í•˜ëŠ” êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

| í•­ëª© | ì‚¬ì–‘ | ë¹„ê³  |
| --- | --- | --- |
| **Jenkins Role** | Controller (Master) | ì›¹ UI ë° ì¡ ìŠ¤ì¼€ì¤„ë§ |
| **Deployment Type** | **StatefulSet** | ê³ ìœ í•œ ìƒíƒœ ë° ë°ì´í„° ìœ ì§€ í•„ìš” |
| **Config Strategy** | **JCasC** (Configuration as Code) | YAML ê¸°ë°˜ ì„¤ì • ìë™í™” |
| **Host OS** | Rocky Linux 9.6 | í´ëŸ¬ìŠ¤í„° ì¸í”„ë¼ í™˜ê²½ |

---

## 2. ìŠ¤í† ë¦¬ì§€ ë° ë°ì´í„° ë³´ì¡´ (Storage & Data)

Jenkinsì˜ ëª¨ë“  ì„¤ì •, í”ŒëŸ¬ê·¸ì¸, ë¹Œë“œ íˆìŠ¤í† ë¦¬ëŠ” ì „ìš© PVì— ì €ì¥ë©ë‹ˆë‹¤.

### ğŸ’¾ ì˜êµ¬ ë³¼ë¥¨ ëª…ì„¸ (PV/PVC)

| PVC Name | PV Name | Capacity | Reclaim Policy | StorageClass |
| --- | --- | --- | --- | --- |
| **jenkins** | **jenkins-pv** | **20Gi** | **Retain** | **manual** |

* **ë°ì´í„° ê²½ë¡œ**: `/var/jenkins_home`
* **ë³´ê´€ ê°€ì¹˜**: í”ŒëŸ¬ê·¸ì¸ ë°ì´í„°, ì‚¬ìš©ì ê³„ì •, Pipeline Definition, Build Logs ë° Artifacts.

---

## 3. ë„¤íŠ¸ì›Œí¬ í†µì‹  ë° ì ‘ì† (Network)

NodePort ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ì™¸ë¶€(ì‚¬ë‚´ë§)ì—ì„œ ëŒ€ì‹œë³´ë“œì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

| ì„œë¹„ìŠ¤ ì´ë¦„ | í¬íŠ¸(ë‚´ë¶€:ì™¸ë¶€) | íƒ€ì… | ìš©ë„ |
| --- | --- | --- | --- |
| `jenkins` | **8080:30000** | **NodePort** | **Jenkins ì›¹ ëŒ€ì‹œë³´ë“œ ì ‘ì†** |
| `jenkins-agent` | 50000 | ClusterIP | Controller-Agent ê°„ JNLP í†µì‹  |

---

## 4. í•µì‹¬ ì„¤ì • ë¦¬ì†ŒìŠ¤ (Configuration & Secrets)

### âš™ï¸ ì£¼ìš” ConfigMap

* **jenkins-jenkins-jcasc-config**: Jenkinsì˜ ì‹œìŠ¤í…œ ì„¤ì •(LDAP, í´ë¼ìš°ë“œ ì—ì´ì „íŠ¸ ì„¤ì •, ë³´ì•ˆ ì„¤ì • ë“±)ì´ ì½”ë“œí™”ë˜ì–´ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
* **jenkins (CM)**: ê¸°ë³¸ í™˜ê²½ ë³€ìˆ˜ ë° ìŠ¤í¬ë¦½íŠ¸ ì •ë³´.

### ğŸ” ì£¼ìš” Secret

* **jenkins (Secret)**: ê´€ë¦¬ì(`admin`) ë¡œê·¸ì¸ ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ë° API í† í°.
* **helm.release**: Jenkins ë°°í¬ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ (v1 ~ v3).

---

## 5. íì‡„ë§ ìš´ì˜ ê°€ì´ë“œ (Air-gapped Operation)

### âœ… í”ŒëŸ¬ê·¸ì¸ ê´€ë¦¬

* ì™¸ë¶€ ì¸í„°ë„· ì—°ê²°ì´ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ, ì‹ ê·œ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ê°€ í•„ìš”í•  ê²½ìš° ì™¸ë¶€ì—ì„œ `.hpi` íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ `jenkins-pv`ì˜ `plugins` ë””ë ‰í† ë¦¬ì— ìˆ˜ë™ìœ¼ë¡œ ë°°ì¹˜í•˜ê±°ë‚˜, í”ŒëŸ¬ê·¸ì¸ì´ í¬í•¨ëœ ìƒˆ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•´ì•¼ í•©ë‹ˆë‹¤.

### âœ… ë™ì  ì—ì´ì „íŠ¸(Slave) êµ¬ì„±

* ë¹Œë“œ ì‹œ ìƒì„±ë˜ëŠ” Podì€ `jenkins-agent` ì„œë¹„ìŠ¤ë¥¼ í†µí•´ Masterì™€ í†µì‹ í•©ë‹ˆë‹¤.
* **ì¤‘ìš”**: Pipeline ì‘ì„± ì‹œ `agent { kubernetes { ... } }` ë¸”ë¡ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ë¯¸ì§€ëŠ” ë°˜ë“œì‹œ ë‚´ë¶€ **GitLab Registry** í˜¹ì€ **Harbor**ì— ì¡´ì¬í•˜ëŠ” ì´ë¯¸ì§€ì—¬ì•¼ í•©ë‹ˆë‹¤.

### âœ… Jenkins Pod êµ¬ì„±

Jenkins PodëŠ” `jenkins-controller` ì»¨í…Œì´ë„ˆì™€ `config-reloader` ì‚¬ì´ë“œì¹´ ì»¨í…Œì´ë„ˆê°€ í•¨ê»˜ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤.
ë”°ë¼ì„œ **JCasC ConfigMap** ì„ ìˆ˜ì •í•˜ê³  ì ìš©í•˜ë©´ ì‚¬ì´ë“œì¹´ê°€ ì´ë¥¼ ê°ì§€í•˜ì—¬ Jenkins ì¬ì‹œì‘ ì—†ì´ ì„¤ì •ì„ ë°˜ì˜í•©ë‹ˆë‹¤.
